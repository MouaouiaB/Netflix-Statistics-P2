USE master
DROP DATABASE IF EXISTS NetflixStatistics;
CREATE DATABASE NetflixStatistics;
GO


/*  Hier maken we tabellen - zie ERD  */

CREATE TABLE Abonnement(
AbonneeID int NOT NULL PRIMARY KEY,
AbonneeNaam nvarchar(20) NOT NULL,
Email nvarchar(50) NOT NULL,
Wachtwoord nvarchar(50) NOT NULL,
Straat nvarchar(40) NOT NULL,             /* Moet ik hier alleen AbonneeAdress doen, of mag het ok zo uitgebeidt (straat, postcode ...)*/
Huisnummer nvarchar(8) NOT NULL,
Postcode nvarchar(7) NOT NULL,
AbonneeWoonplaats nvarchar(20) NOT NULL
);

CREATE TABLE Profile(
Profielnaam nvarchar(30) NOT NULL,
Geboortedatum date NOT NULL,
AbonneeID int CONSTRAINT Profiel_FK REFERENCES Abonnement(AbonneeID) ON DELETE CASCADE ON UPDATE CASCADE,
PRIMARY KEY (Profielnaam, AbonneeID)
);

CREATE TABLE Programma(
ProgrammaID int NOT NULL,
Title nvarchar(50) NOT NULL,
PRIMARY KEY(ProgrammaID, Title)
);

CREATE TABLE Film(
FilmID int NOT NULL PRIMARY KEY,
Title nvarchar(50) NOT NULL,
Tijdsduur time(7) NOT NULL,
Genre nvarchar(20) NOT NULL,
Taal nvarchar(20) NOT NULL,
LeeftijdsIndicatie int NOT NULL,
ProgrammaID int NOT NULL,
FOREIGN KEY(ProgrammaID,Title) REFERENCES Programma(ProgrammaID,Title) ON DELETE CASCADE ON UPDATE CASCADE,
);

CREATE TABLE Serie(
SerieTitle nvarchar(40) NOT NULL PRIMARY KEY,
Genre nvarchar(20) NOT NULL,
Taal nvarchar(20) NOT NULL,
Seizoenen int NOT NULL,
LeeftijdsIndicatie int NOT NULL,
);

CREATE TABLE Aflevering(
AfleveringID int NOT NULL PRIMARY KEY,
Serie nvarchar(40) CONSTRAINT Serie_FK REFERENCES Serie(SerieTitle) ON DELETE CASCADE ON UPDATE CASCADE,
ProgrammaID int NOT NULL,
Title nvarchar(50) NOT NULL,	
Tijdsduur time(7) NOT NULL,
FOREIGN KEY(ProgrammaID,Title) REFERENCES Programma(ProgrammaID,Title) ON DELETE CASCADE ON UPDATE CASCADE,
);
